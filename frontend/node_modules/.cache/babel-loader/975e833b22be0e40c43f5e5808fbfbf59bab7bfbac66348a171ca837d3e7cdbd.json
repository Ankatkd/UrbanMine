{"ast":null,"code":"import axios from 'axios';\n\n// Base URL for your backend API\nexport const API_BASE_URL = 'http://localhost:8082'; // IMPORTANT: Ensure this matches your Spring Boot backend URL\n\nconst api = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Request Interceptor: This runs BEFORE every request is sent.\n// Its purpose is to attach the JWT token from localStorage to the Authorization header\n// for all requests made using this 'api' (Axios) instance.\napi.interceptors.request.use(config => {\n  const token = localStorage.getItem('token'); // Retrieve the user's JWT token\n  if (token) {\n    // If a token exists, add it to the Authorization header in the Bearer format\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config; // Return the modified config\n}, error => {\n  // Handle request errors (e.g., network issues before sending)\n  return Promise.reject(error);\n});\n\n// Response Interceptor: This runs AFTER a response is received.\n// It's useful for handling global error conditions like unauthorized access (401)\n// or forbidden access (403), which often mean the token is invalid or expired.\napi.interceptors.response.use(response => response,\n// If the response is successful (2xx status), just pass it through\nerror => {\n  // Check if the error response exists and if its status is 401 (Unauthorized) or 403 (Forbidden)\n  if (error.response && (error.response.status === 401 || error.response.status === 403)) {\n    console.error('API Error: Unauthorized or Forbidden. Logging out user due to invalid/expired token.');\n    // Dispatch a custom event. This is a robust way to inform other parts of the application\n    // (like the Header or the App component) that the user's login status needs to be re-evaluated,\n    // typically leading to a logout.\n    window.dispatchEvent(new Event('loginStatusChanged'));\n    // Note: Direct navigation (e.g., `window.location.href = '/login';`) is often done\n    // by a component that listens to `loginStatusChanged` to avoid direct side effects\n    // within the interceptor.\n  }\n  return Promise.reject(error); // Propagate the error so calling components can also handle it\n});\nexport default api; // Export the configured Axios instance","map":{"version":3,"names":["axios","API_BASE_URL","api","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","error","Promise","reject","response","status","console","window","dispatchEvent","Event"],"sources":["C:/Users/ankao/OneDrive/Desktop/nilesh/E-waste/frontend/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// Base URL for your backend API\r\nexport const API_BASE_URL = 'http://localhost:8082'; // IMPORTANT: Ensure this matches your Spring Boot backend URL\r\n\r\nconst api = axios.create({\r\n    baseURL: API_BASE_URL,\r\n    headers: {\r\n        'Content-Type': 'application/json',\r\n    },\r\n});\r\n\r\n// Request Interceptor: This runs BEFORE every request is sent.\r\n// Its purpose is to attach the JWT token from localStorage to the Authorization header\r\n// for all requests made using this 'api' (Axios) instance.\r\napi.interceptors.request.use(\r\n    (config) => {\r\n        const token = localStorage.getItem('token'); // Retrieve the user's JWT token\r\n        if (token) {\r\n            // If a token exists, add it to the Authorization header in the Bearer format\r\n            config.headers.Authorization = `Bearer ${token}`;\r\n        }\r\n        return config; // Return the modified config\r\n    },\r\n    (error) => {\r\n        // Handle request errors (e.g., network issues before sending)\r\n        return Promise.reject(error);\r\n    }\r\n);\r\n\r\n// Response Interceptor: This runs AFTER a response is received.\r\n// It's useful for handling global error conditions like unauthorized access (401)\r\n// or forbidden access (403), which often mean the token is invalid or expired.\r\napi.interceptors.response.use(\r\n    (response) => response, // If the response is successful (2xx status), just pass it through\r\n    (error) => {\r\n        // Check if the error response exists and if its status is 401 (Unauthorized) or 403 (Forbidden)\r\n        if (error.response && (error.response.status === 401 || error.response.status === 403)) {\r\n            console.error('API Error: Unauthorized or Forbidden. Logging out user due to invalid/expired token.');\r\n            // Dispatch a custom event. This is a robust way to inform other parts of the application\r\n            // (like the Header or the App component) that the user's login status needs to be re-evaluated,\r\n            // typically leading to a logout.\r\n            window.dispatchEvent(new Event('loginStatusChanged'));\r\n            // Note: Direct navigation (e.g., `window.location.href = '/login';`) is often done\r\n            // by a component that listens to `loginStatusChanged` to avoid direct side effects\r\n            // within the interceptor.\r\n        }\r\n        return Promise.reject(error); // Propagate the error so calling components can also handle it\r\n    }\r\n);\r\n\r\nexport default api; // Export the configured Axios instance"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;;AAEzB;AACA,OAAO,MAAMC,YAAY,GAAG,uBAAuB,CAAC,CAAC;;AAErD,MAAMC,GAAG,GAAGF,KAAK,CAACG,MAAM,CAAC;EACrBC,OAAO,EAAEH,YAAY;EACrBI,OAAO,EAAE;IACL,cAAc,EAAE;EACpB;AACJ,CAAC,CAAC;;AAEF;AACA;AACA;AACAH,GAAG,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CACvBC,MAAM,IAAK;EACR,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;EAC7C,IAAIF,KAAK,EAAE;IACP;IACAD,MAAM,CAACJ,OAAO,CAACQ,aAAa,GAAG,UAAUH,KAAK,EAAE;EACpD;EACA,OAAOD,MAAM,CAAC,CAAC;AACnB,CAAC,EACAK,KAAK,IAAK;EACP;EACA,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAChC,CACJ,CAAC;;AAED;AACA;AACA;AACAZ,GAAG,CAACI,YAAY,CAACW,QAAQ,CAACT,GAAG,CACxBS,QAAQ,IAAKA,QAAQ;AAAE;AACvBH,KAAK,IAAK;EACP;EACA,IAAIA,KAAK,CAACG,QAAQ,KAAKH,KAAK,CAACG,QAAQ,CAACC,MAAM,KAAK,GAAG,IAAIJ,KAAK,CAACG,QAAQ,CAACC,MAAM,KAAK,GAAG,CAAC,EAAE;IACpFC,OAAO,CAACL,KAAK,CAAC,sFAAsF,CAAC;IACrG;IACA;IACA;IACAM,MAAM,CAACC,aAAa,CAAC,IAAIC,KAAK,CAAC,oBAAoB,CAAC,CAAC;IACrD;IACA;IACA;EACJ;EACA,OAAOP,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC,CAAC,CAAC;AAClC,CACJ,CAAC;AAED,eAAeZ,GAAG,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}