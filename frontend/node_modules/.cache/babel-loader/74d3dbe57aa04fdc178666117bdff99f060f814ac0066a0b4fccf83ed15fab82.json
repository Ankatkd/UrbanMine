{"ast":null,"code":"// src/services/workerApi.js\nimport axios from 'axios';\n\n// Assuming your backend is running on http://localhost:8082\nconst API_BASE_URL = 'http://localhost:8082/api/worker';\nconst PICKUP_API_BASE_URL = 'http://localhost:8082/api/worker/pickups'; // New base URL for worker-specific pickups\n\n// Helper to get authentication headers\nconst getAuthHeaders = () => {\n  const token = localStorage.getItem('workerToken');\n  return token ? {\n    Authorization: `Bearer ${token}`\n  } : {};\n};\nexport const registerWorker = async workerData => {\n  try {\n    const response = await axios.post(`${API_BASE_URL}/register`, workerData);\n    return response.data; // Returns \"Worker registered successfully!\" on success\n  } catch (error) {\n    throw error.response ? error.response.data : error.message;\n  }\n};\nexport const loginWorker = async credentials => {\n  try {\n    const response = await axios.post(`${API_BASE_URL}/login`, credentials);\n    return response.data; // Returns { message, userId, token, role } on success\n  } catch (error) {\n    throw error.response ? error.response.data : error.message;\n  }\n};\n\n// --- NEW: Fetch Worker Profile ---\nexport const getWorkerProfile = async () => {\n  try {\n    const headers = getAuthHeaders();\n    if (!headers.Authorization) {\n      throw new Error('No authentication token found.');\n    }\n    const response = await axios.get(`${API_BASE_URL}/profile`, {\n      headers\n    });\n    return response.data; // Expected to return worker details (Worker model without password)\n  } catch (error) {\n    throw error.response ? error.response.data : error.message;\n  }\n};\n\n// --- NEW: Fetch All Pickup Requests Assigned to Worker ---\nexport const getWorkerPickupRequests = async () => {\n  try {\n    const headers = getAuthHeaders();\n    if (!headers.Authorization) {\n      throw new Error('No authentication token found.');\n    }\n    const response = await axios.get(`${PICKUP_API_BASE_URL}/`, {\n      headers\n    });\n    return response.data; // Expected to return List<PickupRequest>\n  } catch (error) {\n    throw error.response ? error.response.data : error.message;\n  }\n};\n\n// --- NEW: Fetch Today's Pending Pickups for Worker ---\nexport const getTodaysPendingPickups = async () => {\n  try {\n    const headers = getAuthHeaders();\n    if (!headers.Authorization) {\n      throw new Error('No authentication token found.');\n    }\n    const response = await axios.get(`${PICKUP_API_BASE_URL}/today/pending`, {\n      headers\n    });\n    return response.data; // Expected to return List<PickupRequest>\n  } catch (error) {\n    throw error.response ? error.response.data : error.message;\n  }\n};\n\n// --- NEW: Update Pickup Request Status ---\nexport const updatePickupRequestStatus = async (requestId, newStatus) => {\n  try {\n    const headers = getAuthHeaders();\n    if (!headers.Authorization) {\n      throw new Error('No authentication token found.');\n    }\n    const response = await axios.put(`${PICKUP_API_BASE_URL}/${requestId}/status?status=${newStatus}`, {}, {\n      headers\n    });\n    return response.data; // Expected to return the updated PickupRequest\n  } catch (error) {\n    throw error.response ? error.response.data : error.message;\n  }\n};","map":{"version":3,"names":["axios","API_BASE_URL","PICKUP_API_BASE_URL","getAuthHeaders","token","localStorage","getItem","Authorization","registerWorker","workerData","response","post","data","error","message","loginWorker","credentials","getWorkerProfile","headers","Error","get","getWorkerPickupRequests","getTodaysPendingPickups","updatePickupRequestStatus","requestId","newStatus","put"],"sources":["C:/Users/ankao/OneDrive/Desktop/nilesh/E-waste/frontend/src/services/workerApi.js"],"sourcesContent":["// src/services/workerApi.js\r\nimport axios from 'axios';\r\n\r\n// Assuming your backend is running on http://localhost:8082\r\nconst API_BASE_URL = 'http://localhost:8082/api/worker';\r\nconst PICKUP_API_BASE_URL = 'http://localhost:8082/api/worker/pickups'; // New base URL for worker-specific pickups\r\n\r\n// Helper to get authentication headers\r\nconst getAuthHeaders = () => {\r\n    const token = localStorage.getItem('workerToken');\r\n    return token ? { Authorization: `Bearer ${token}` } : {};\r\n};\r\n\r\nexport const registerWorker = async (workerData) => {\r\n    try {\r\n        const response = await axios.post(`${API_BASE_URL}/register`, workerData);\r\n        return response.data; // Returns \"Worker registered successfully!\" on success\r\n    } catch (error) {\r\n        throw error.response ? error.response.data : error.message;\r\n    }\r\n};\r\n\r\nexport const loginWorker = async (credentials) => {\r\n    try {\r\n        const response = await axios.post(`${API_BASE_URL}/login`, credentials);\r\n        return response.data; // Returns { message, userId, token, role } on success\r\n    } catch (error) {\r\n        throw error.response ? error.response.data : error.message;\r\n    }\r\n};\r\n\r\n// --- NEW: Fetch Worker Profile ---\r\nexport const getWorkerProfile = async () => {\r\n    try {\r\n        const headers = getAuthHeaders();\r\n        if (!headers.Authorization) {\r\n            throw new Error('No authentication token found.');\r\n        }\r\n        const response = await axios.get(`${API_BASE_URL}/profile`, { headers });\r\n        return response.data; // Expected to return worker details (Worker model without password)\r\n    } catch (error) {\r\n        throw error.response ? error.response.data : error.message;\r\n    }\r\n};\r\n\r\n// --- NEW: Fetch All Pickup Requests Assigned to Worker ---\r\nexport const getWorkerPickupRequests = async () => {\r\n    try {\r\n        const headers = getAuthHeaders();\r\n        if (!headers.Authorization) {\r\n            throw new Error('No authentication token found.');\r\n        }\r\n        const response = await axios.get(`${PICKUP_API_BASE_URL}/`, { headers });\r\n        return response.data; // Expected to return List<PickupRequest>\r\n    } catch (error) {\r\n        throw error.response ? error.response.data : error.message;\r\n    }\r\n};\r\n\r\n// --- NEW: Fetch Today's Pending Pickups for Worker ---\r\nexport const getTodaysPendingPickups = async () => {\r\n    try {\r\n        const headers = getAuthHeaders();\r\n        if (!headers.Authorization) {\r\n            throw new Error('No authentication token found.');\r\n        }\r\n        const response = await axios.get(`${PICKUP_API_BASE_URL}/today/pending`, { headers });\r\n        return response.data; // Expected to return List<PickupRequest>\r\n    } catch (error) {\r\n        throw error.response ? error.response.data : error.message;\r\n    }\r\n};\r\n\r\n// --- NEW: Update Pickup Request Status ---\r\nexport const updatePickupRequestStatus = async (requestId, newStatus) => {\r\n    try {\r\n        const headers = getAuthHeaders();\r\n        if (!headers.Authorization) {\r\n            throw new Error('No authentication token found.');\r\n        }\r\n        const response = await axios.put(`${PICKUP_API_BASE_URL}/${requestId}/status?status=${newStatus}`, {}, { headers });\r\n        return response.data; // Expected to return the updated PickupRequest\r\n    } catch (error) {\r\n        throw error.response ? error.response.data : error.message;\r\n    }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}